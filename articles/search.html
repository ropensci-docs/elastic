<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="elastic">
<title>elastic searching â€¢ elastic</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="elastic searching">
<meta property="og:description" content="elastic">
<meta property="og:image" content="https://docs.ropensci.org/elastic/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">elastic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.1.91</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/elastic.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/elastic/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>elastic searching</h1>
                        <h4 data-toc-skip class="author">Scott Chamberlain</h4>
            
            <h4 data-toc-skip class="date">2020-07-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/elastic/blob/HEAD/vignettes/search.Rmd" class="external-link"><code>vignettes/search.Rmd</code></a></small>
      <div class="d-none name"><code>search.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="load-elastic">Load elastic<a class="anchor" aria-label="anchor" href="#load-elastic"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/elastic/">"elastic"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-search-function">The Search function<a class="anchor" aria-label="anchor" href="#the-search-function"></a>
</h2>
<p>The main interface to searching documents in your Elasticsearch store is the function <code><a href="../reference/Search.html">Search()</a></code>. I nearly always develop R software using all lowercase, but R has a function called <code><a href="https://rdrr.io/r/base/search.html" class="external-link">search()</a></code>, and I wanted to avoid collision with that function.</p>
<p><code><a href="../reference/Search.html">Search()</a></code> is an interface to both the HTTP search API (in which queries are passed in the URI of the request, meaning queries have to be relatively simple), as well as the POST API, or the Query DSL, in which queries are passed in the body of the request (so can be much more complex).</p>
<p>There are a huge amount of ways you can search Elasticsearch documents - this tutorial covers some of them, and highlights the ways in which you interact with the R outputs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect.html">connect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="search-an-index">Search an index<a class="anchor" aria-label="anchor" href="#search-an-index"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "ACT I"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="search-an-index-by-type">Search an index by type<a class="anchor" aria-label="anchor" href="#search-an-index-by-type"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index <span class="op">=</span> <span class="st">"shakespeare"</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "ACT I"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="return-certain-fields">Return certain fields<a class="anchor" aria-label="anchor" href="#return-certain-fields"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index <span class="op">=</span> <span class="st">"shakespeare"</span>, body <span class="op">=</span> <span class="st">'{</span></span>
<span><span class="st">  "_source": ["play_name", "speaker"]</span></span>
<span><span class="st">}'</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="paging">Paging<a class="anchor" aria-label="anchor" href="#paging"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, size<span class="op">=</span><span class="fl">1</span>, from<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $total</span></span>
<span><span class="co">#&gt; $total$value</span></span>
<span><span class="co">#&gt; [1] 5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $total$relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_score</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits</span></span>
<span><span class="co">#&gt; $hits[[1]]</span></span>
<span><span class="co">#&gt; $hits[[1]]$`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_id`</span></span>
<span><span class="co">#&gt; [1] "1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`</span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hits[[1]]$`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "SCENE I. London. The palace."</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="queries">Queries<a class="anchor" aria-label="anchor" href="#queries"></a>
</h3>
<p>Using the <code>q</code> parameter you can pass in a query, which gets passed in the URI of the query. This type of query is less powerful than the below query passed in the body of the request, using the <code>body</code> parameter.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, q<span class="op">=</span><span class="st">"speaker:KING HENRY IV"</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="section level4">
<h4 id="more-complex-queries">More complex queries<a class="anchor" aria-label="anchor" href="#more-complex-queries"></a>
</h4>
<p>Here, query for values from 10 to 20 in the field <code>line_id</code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, q<span class="op">=</span><span class="st">"line_id:[10 TO 20]"</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="get-version-number-for-each-document">Get version number for each document<a class="anchor" aria-label="anchor" href="#get-version-number-for-each-document"></a>
</h3>
<p>Version number usually is not returned.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, version<span class="op">=</span><span class="cn">TRUE</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span>, <span class="st">"[["</span>, <span class="st">"_version"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 1 1</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="get-raw-data">Get raw data<a class="anchor" aria-label="anchor" href="#get-raw-data"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, raw<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "{\"took\":0,\"timed_out\":false,\"_shards\":{\"total\":1,\"successful\":1,\"skipped\":0,\"failed\":0},\"hits\":{\"total\":{\"value\":5000,\"relation\":\"eq\"},\"max_score\":1.0,\"hits\":[{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"0\",\"_score\":1.0,\"_source\":{\"line_id\":1,\"play_name\":\"Henry IV\",\"line_number\":\"\",\"speaker\":\"\",\"text_entry\":\"ACT I\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"1\",\"_score\":1.0,\"_source\":{\"line_id\":2,\"play_name\":\"Henry IV\",\"line_number\":\"\",\"speaker\":\"\",\"text_entry\":\"SCENE I. London. The palace.\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"2\",\"_score\":1.0,\"_source\":{\"line_id\":3,\"play_name\":\"Henry IV\",\"line_number\":\"\",\"speaker\":\"\",\"text_entry\":\"Enter KING HENRY, LORD JOHN OF LANCASTER, the EARL of WESTMORELAND, SIR WALTER BLUNT, and others\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"3\",\"_score\":1.0,\"_source\":{\"line_id\":4,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.1\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"So shaken as we are, so wan with care,\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"4\",\"_score\":1.0,\"_source\":{\"line_id\":5,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.2\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"Find we a time for frighted peace to pant,\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"5\",\"_score\":1.0,\"_source\":{\"line_id\":6,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.3\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"And breathe short-winded accents of new broils\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"6\",\"_score\":1.0,\"_source\":{\"line_id\":7,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.4\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"To be commenced in strands afar remote.\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"7\",\"_score\":1.0,\"_source\":{\"line_id\":8,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.5\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"No more the thirsty entrance of this soil\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"8\",\"_score\":1.0,\"_source\":{\"line_id\":9,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.6\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"Shall daub her lips with her own childrens blood;\"}},{\"_index\":\"shakespeare\",\"_type\":\"_doc\",\"_id\":\"9\",\"_score\":1.0,\"_source\":{\"line_id\":10,\"play_name\":\"Henry IV\",\"speech_number\":1,\"line_number\":\"1.1.7\",\"speaker\":\"KING HENRY IV\",\"text_entry\":\"Nor more shall trenching war channel her fields,\"}}]}}"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="curl-debugging">Curl debugging<a class="anchor" aria-label="anchor" href="#curl-debugging"></a>
</h3>
<p>Common options are <code>verbose=TRUE</code>, <code>timeout_ms=1</code>, <code>followlocation=TRUE</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="query-dsl-searches---queries-sent-in-the-body-of-the-request">Query DSL searches - queries sent in the body of the request<a class="anchor" aria-label="anchor" href="#query-dsl-searches---queries-sent-in-the-body-of-the-request"></a>
</h3>
<p>Pass in as an R list</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/mapping.html">mapping_create</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"shakespeare"</span>, update_all_types <span class="op">=</span> <span class="cn">TRUE</span>, body <span class="op">=</span> <span class="st">'{</span></span>
<span><span class="st">   "properties": {</span></span>
<span><span class="st">     "text_entry": {</span></span>
<span><span class="st">       "type":     "text",</span></span>
<span><span class="st">       "fielddata": true</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">  }</span></span>
<span><span class="st">}'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $acknowledged</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>aggs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"text_entry"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body<span class="op">=</span><span class="va">aggs</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "ACT I"</span></span></code></pre>
<p>Or pass in as json query with newlines, easy to read</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggs</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "aggs": {</span></span>
<span><span class="st">        "stats" : {</span></span>
<span><span class="st">            "terms" : {</span></span>
<span><span class="st">                "field" : "text_entry"</span></span>
<span><span class="st">            }</span></span>
<span><span class="st">        }</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body<span class="op">=</span><span class="va">aggs</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "ACT I"</span></span></code></pre>
<p>Or pass in collapsed json string</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggs</span> <span class="op">&lt;-</span> <span class="st">'{"aggs":{"stats":{"terms":{"field":"text_entry"}}}}'</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body<span class="op">=</span><span class="va">aggs</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $`_index`</span></span>
<span><span class="co">#&gt; [1] "shakespeare"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_type`</span></span>
<span><span class="co">#&gt; [1] "_doc"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_id`</span></span>
<span><span class="co">#&gt; [1] "0"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_score`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`</span></span>
<span><span class="co">#&gt; $`_source`$line_id</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$play_name</span></span>
<span><span class="co">#&gt; [1] "Henry IV"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$line_number</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$speaker</span></span>
<span><span class="co">#&gt; [1] ""</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`_source`$text_entry</span></span>
<span><span class="co">#&gt; [1] "ACT I"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="aggregations">Aggregations<a class="anchor" aria-label="anchor" href="#aggregations"></a>
</h3>
<p>Histograms</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aggs</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st">    "aggs": {</span></span>
<span><span class="st">        "latbuckets" : {</span></span>
<span><span class="st">           "histogram" : {</span></span>
<span><span class="st">               "field" : "decimalLatitude",</span></span>
<span><span class="st">               "interval" : 5</span></span>
<span><span class="st">           }</span></span>
<span><span class="st">        }</span></span>
<span><span class="st">    }</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"gbif"</span>, body<span class="op">=</span><span class="va">aggs</span>, size<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">$</span><span class="va">aggregations</span><span class="op">$</span><span class="va">latbuckets</span><span class="op">$</span><span class="va">buckets</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$key</span></span>
<span><span class="co">#&gt; [1] -35</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$doc_count</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [[2]]$key</span></span>
<span><span class="co">#&gt; [1] -30</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]$doc_count</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [[3]]$key</span></span>
<span><span class="co">#&gt; [1] -25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]$doc_count</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="a-bool-query">A bool query<a class="anchor" aria-label="anchor" href="#a-bool-query"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mmatch</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st"> "query": {</span></span>
<span><span class="st">   "bool" : {</span></span>
<span><span class="st">     "must_not" : {</span></span>
<span><span class="st">       "range" : {</span></span>
<span><span class="st">         "speech_number" : {</span></span>
<span><span class="st">           "from" : 1, "to": 5</span></span>
<span><span class="st">}}}}}}'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body<span class="op">=</span><span class="va">mmatch</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">`_source`</span><span class="op">$</span><span class="va">speech_number</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; [1] 7</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fuzzy-query">Fuzzy query<a class="anchor" aria-label="anchor" href="#fuzzy-query"></a>
</h3>
<p>Fuzzy query on numerics</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fuzzy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fuzzy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text_entry <span class="op">=</span> <span class="st">"arms"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body <span class="op">=</span> <span class="va">fuzzy</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 49</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fuzzy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fuzzy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text_entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="st">"arms"</span>, fuzziness <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">"shakespeare"</span>, body<span class="op">=</span><span class="va">fuzzy</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 618</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="range-query">Range query<a class="anchor" aria-label="anchor" href="#range-query"></a>
</h3>
<p>With numeric</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>decimalLongitude<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gte<span class="op">=</span><span class="fl">1</span>, lte<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'gbif'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 24</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>decimalLongitude<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gte<span class="op">=</span><span class="fl">2.9</span>, lte<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'gbif'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 126</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<p>With dates</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eventDate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gte<span class="op">=</span><span class="st">"2012-01-01"</span>, lte<span class="op">=</span><span class="st">"now"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'gbif'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 301</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>query<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>range<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>eventDate<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gte<span class="op">=</span><span class="st">"2014-01-01"</span>, lte<span class="op">=</span><span class="st">"now"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'gbif'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 292</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="more-like-this-query-more_like_this-can-be-shortened-to-mlt">More-like-this query (more_like_this can be shortened to mlt)<a class="anchor" aria-label="anchor" href="#more-like-this-query-more_like_this-can-be-shortened-to-mlt"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st"> "query": {</span></span>
<span><span class="st">   "more_like_this": {</span></span>
<span><span class="st">     "fields": ["abstract","title"],</span></span>
<span><span class="st">     "like": "and then",</span></span>
<span><span class="st">     "min_term_freq": 1,</span></span>
<span><span class="st">     "max_query_terms": 12</span></span>
<span><span class="st">   }</span></span>
<span><span class="st"> }</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'plos'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 488</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st"> "query": {</span></span>
<span><span class="st">   "more_like_this": {</span></span>
<span><span class="st">     "fields": ["abstract","title"],</span></span>
<span><span class="st">     "like": "cell",</span></span>
<span><span class="st">     "min_term_freq": 1,</span></span>
<span><span class="st">     "max_query_terms": 12</span></span>
<span><span class="st">   }</span></span>
<span><span class="st"> }</span></span>
<span><span class="st">}'</span></span>
<span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'plos'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 58</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="highlighting">Highlighting<a class="anchor" aria-label="anchor" href="#highlighting"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">body</span> <span class="op">&lt;-</span> <span class="st">'{</span></span>
<span><span class="st"> "query": {</span></span>
<span><span class="st">   "query_string": {</span></span>
<span><span class="st">     "query" : "cell"</span></span>
<span><span class="st">   }</span></span>
<span><span class="st"> },</span></span>
<span><span class="st"> "highlight": {</span></span>
<span><span class="st">   "fields": {</span></span>
<span><span class="st">     "title": {"number_of_fragments": 2}</span></span>
<span><span class="st">   }</span></span>
<span><span class="st"> }</span></span>
<span><span class="st">}'</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'plos'</span>, body<span class="op">=</span><span class="va">body</span><span class="op">)</span></span>
<span><span class="va">out</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 58</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">highlight</span><span class="op">$</span><span class="va">title</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] "Functional Analysis of the Drosophila Embryonic Germ &lt;em&gt;Cell&lt;/em&gt; Transcriptome by RNA Interference"</span></span>
<span><span class="co">#&gt; [2] "Diversin Is Overexpressed in Breast Cancer and Accelerates &lt;em&gt;Cell&lt;/em&gt; Proliferation and Invasion" </span></span>
<span><span class="co">#&gt; [3] "c-FLIP Protects Eosinophils from TNF-Î±-Mediated &lt;em&gt;Cell&lt;/em&gt; Death In Vivo"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="scrolling-search---instead-of-paging">Scrolling search - instead of paging<a class="anchor" aria-label="anchor" href="#scrolling-search---instead-of-paging"></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'shakespeare'</span>, q<span class="op">=</span><span class="st">"a*"</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 2747</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index <span class="op">=</span> <span class="st">'shakespeare'</span>, q<span class="op">=</span><span class="st">"a*"</span>, time_scroll <span class="op">=</span> <span class="st">"1m"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="../reference/scroll.html">scroll</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">res</span><span class="op">$</span><span class="va">`_scroll_id`</span>, time_scroll <span class="op">=</span> <span class="st">"1m"</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 10</span></span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, index <span class="op">=</span> <span class="st">'shakespeare'</span>, q <span class="op">=</span> <span class="st">"a*"</span>, time_scroll <span class="op">=</span> <span class="st">"5m"</span><span class="op">)</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span></span>
<span><span class="va">hits</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="va">hits</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/scroll.html">scroll</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">res</span><span class="op">$</span><span class="va">`_scroll_id`</span><span class="op">)</span></span>
<span>  <span class="va">hits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">hits</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">out</span>, <span class="va">res</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 2747</span></span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">total</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 2747</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $relation</span></span>
<span><span class="co">#&gt; [1] "eq"</span></span></code></pre>
<p>Woohoo! Collected all 2747 documents in very little time.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
