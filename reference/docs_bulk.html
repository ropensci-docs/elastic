<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Use the bulk API to create, index, update, or delete documents."><title>Use the bulk API to create, index, update, or delete documents. — docs_bulk • elastic</title><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use the bulk API to create, index, update, or delete documents. — docs_bulk"><meta property="og:description" content="Use the bulk API to create, index, update, or delete documents."><meta property="og:image" content="https://docs.ropensci.org/elastic/logo.png"><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css"><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript><!-- End Matomo Code --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">elastic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.1.91</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="nav-link" href="../articles/elastic.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/elastic/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Use the bulk API to create, index, update, or delete documents.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/elastic/blob/HEAD/R/docs_bulk.r" class="external-link"><code>R/docs_bulk.r</code></a></small>
      <div class="d-none name"><code>docs_bulk.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use the bulk API to create, index, update, or delete documents.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">docs_bulk</span><span class="op">(</span></span>
<span>  <span class="va">conn</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  index <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  doc_ids <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  es_ids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  raw <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  sf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>conn</dt>
<dd><p>an Elasticsearch connection object, see <code><a href="connect.html">connect()</a></code></p></dd>


<dt>x</dt>
<dd><p>A list, data.frame, or character path to a file. required.</p></dd>


<dt>index</dt>
<dd><p>(character) The index name to use. Required for data.frame
input, but optional for file inputs.</p></dd>


<dt>type</dt>
<dd><p>(character) The type. default: <code>NULL</code>. Note that <code>type</code> is
deprecated in Elasticsearch v7 and greater, and removed in Elasticsearch v8</p></dd>


<dt>chunk_size</dt>
<dd><p>(integer) Size of each chunk. If your data.frame is smaller
thank <code>chunk_size</code>, this parameter is essentially ignored. We write in
chunks because at some point, depending on size of each document, and
Elasticsearch setup, writing a very large number of documents in one go
becomes slow, so chunking can help. This parameter is ignored if you
pass a file name. Default: 1000</p></dd>


<dt>doc_ids</dt>
<dd><p>An optional vector (character or numeric/integer) of document
ids to use. This vector has to equal the size of the documents you are
passing in, and will error if not. If you pass a factor we convert to
character. Default: not passed</p></dd>


<dt>es_ids</dt>
<dd><p>(boolean) Let Elasticsearch assign document IDs as UUIDs.
These are sequential, so there is order to the IDs they assign.
If <code>TRUE</code>, <code>doc_ids</code> is ignored. Default: <code>TRUE</code></p></dd>


<dt>raw</dt>
<dd><p>(logical) Get raw JSON back or not. If <code>TRUE</code>
you get JSON; if <code>FALSE</code> you get a list. Default: <code>FALSE</code></p></dd>


<dt>quiet</dt>
<dd><p>(logical) Suppress progress bar. Default: <code>FALSE</code></p></dd>


<dt>query</dt>
<dd><p>(list) a named list of query parameters. optional.
options include: pipeline, refresh, routing, _source, _source_excludes,
_source_includes, timeout, wait_for_active_shards. See the docs bulk
ES page for details</p></dd>


<dt>digits</dt>
<dd><p>digits used by the parameter of the same name by
<code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::toJSON()</a></code> to convert data to JSON before being submitted to
your ES instance. default: <code>NA</code></p></dd>


<dt>sf</dt>
<dd><p>used by <code><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html" class="external-link">jsonlite::toJSON()</a></code> to convert sf objects.
Set to "features" for conversion to GeoJSON. default: "dataframe"</p></dd>


<dt>...</dt>
<dd><p>Pass on curl options to <a href="https://docs.ropensci.org/crul/reference/HttpClient.html" class="external-link">crul::HttpClient</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>More on the Bulk API:
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html" class="external-link">https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html</a></p>
<p>This function dispatches on data.frame or character input. Character input
has to be a file name or the function stops with an error message.</p>
<p>If you pass a data.frame to this function, we by default do an index
operation, that is, create the record in the index given by those
parameters to the function. Down the road perhaps we will try to support
other operations on the bulk API. if you pass a file, of course in that
file, you can specify any operations you want.</p>
<p>Row names are dropped from data.frame, and top level names for a list
are dropped as well.</p>
<p>A progress bar gives the progress for data.frames and lists - the progress
bar is based around a for loop, where progress indicates progress along
the iterations of the for loop, where each iteration is a chunk of data
that's converted to bulk format, then pushed into Elasticsearch. The
<code>character</code> method has no for loop, so no progress bar.</p>
    </div>
    <div class="section level2">
    <h2 id="document-ids">Document IDs<a class="anchor" aria-label="anchor" href="#document-ids"></a></h2>
    

<p>Document IDs can be passed in via the <code>doc_ids</code> paramater when passing
in data.frame or list, but not with files. If ids are not passed to
<code>doc_ids</code>, we assign document IDs from 1 to length of the object
(rows of a data.frame, or length of a list). In the future we may allow the
user to select whether they want to assign sequential numeric IDs or
to allow Elasticsearch to assign IDs, which are UUIDs that are actually
sequential, so you still can determine an order of your documents.</p>
    </div>
    <div class="section level2">
    <h2 id="document-ids-and-factors">Document IDs and Factors<a class="anchor" aria-label="anchor" href="#document-ids-and-factors"></a></h2>
    

<p>If you pass in ids that are of class factor, we coerce them to character
with <code>as.character</code>. This applies to both data.frame and list inputs, but
not to file inputs.</p>
    </div>
    <div class="section level2">
    <h2 id="large-numbers-for-document-ids">Large numbers for document IDs<a class="anchor" aria-label="anchor" href="#large-numbers-for-document-ids"></a></h2>
    

<p>Until recently, if you had very large integers for document IDs,
<code>docs_bulk</code> failed. It should be fixed now. Let us know if not.</p>
    </div>
    <div class="section level2">
    <h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a></h2>
    

<p>As of <span class="pkg">elastic</span> version <code>0.7.8.9515</code> we convert <code>NA</code> to
<code>null</code> before loading into Elasticsearch. Previously, fields that
had an <code>NA</code> were dropped - but when you read data back from
Elasticsearch into R, you retain those missing values as <span class="pkg">jsonlite</span>
fills those in for you. Now, fields with <code>NA</code>'s are made into
<code>null</code>, and are not dropped in Elasticsearch.</p>
<p>Note also that null values can not be indexed or searched
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/5.3/null-value.html" class="external-link">https://www.elastic.co/guide/en/elasticsearch/reference/5.3/null-value.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="tips">Tips<a class="anchor" aria-label="anchor" href="#tips"></a></h2>
    

<p>This function returns the response from Elasticsearch, but you'll likely
not be that interested in the response. If not, wrap your call to
<code>docs_bulk</code> in <code><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible()</a></code>, like so: <code>invisible(docs_bulk(...))</code></p>
    </div>
    <div class="section level2">
    <h2 id="connections-files">Connections/Files<a class="anchor" aria-label="anchor" href="#connections-files"></a></h2>
    

<p>We create temporary files, and connections to those files, when data.frame's
and lists are passed in to <code>docs_bulk()</code> (not when a file is passed in
since we don't need to create a file). After inserting data into your
Elasticsearch instance, we close the connections and delete the temporary files.</p>
<p>There are some exceptions though. When you pass in your own file, whether a
tempfile or not, we don't delete those files after using them - in case
you need those files again. Your own tempfile's will be cleaned up/delete
when the R session ends. Non-tempfile's won't be cleaned up/deleted after
the R session ends.</p>
    </div>
    <div class="section level2">
    <h2 id="elasticsearch-versions-that-don-t-support-type">Elasticsearch versions that don't support type<a class="anchor" aria-label="anchor" href="#elasticsearch-versions-that-don-t-support-type"></a></h2>
    

<p>See the <code><a href="type_remover.html">type_remover()</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other bulk-functions: 
<code><a href="docs_bulk_create.html">docs_bulk_create</a>()</code>,
<code><a href="docs_bulk_delete.html">docs_bulk_delete</a>()</code>,
<code><a href="docs_bulk_index.html">docs_bulk_index</a>()</code>,
<code><a href="docs_bulk_prep.html">docs_bulk_prep</a>()</code>,
<code><a href="docs_bulk_update.html">docs_bulk_update</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># connection setup</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="connect.html">connect</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># From a file already in newline delimited JSON format</span></span></span>
<span class="r-in"><span><span class="va">plosdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"plos_data.json"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">plosdat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="alias.html">aliases_get</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, index<span class="op">=</span><span class="st">'plos'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="alias.html">aliases_get</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># From a data.frame</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">mtcars</span>, index <span class="op">=</span> <span class="st">"hello"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## field names cannot contain dots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">iris</span>, <span class="st">"iris"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## type can be missing, but index can not</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">iris</span>, <span class="st">"flowers"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## big data.frame, 53K rows, load ggplot2 package first</span></span></span>
<span class="r-in"><span><span class="co"># res &lt;- docs_bulk(x, diamonds, "diam")</span></span></span>
<span class="r-in"><span><span class="co"># Search(x, "diam")$hits$total</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># From a list</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">1</span>, <span class="va">as.list</span><span class="op">)</span>, index<span class="op">=</span><span class="st">"iris"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">USArrests</span>, <span class="fl">1</span>, <span class="va">as.list</span><span class="op">)</span>, index<span class="op">=</span><span class="st">"arrests"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># dim_list &lt;- apply(diamonds, 1, as.list)</span></span></span>
<span class="r-in"><span><span class="co"># out &lt;- docs_bulk(x, dim_list, index="diamfromlist")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># When using in a loop</span></span></span>
<span class="r-in"><span><span class="co">## We internally get last _id counter to know where to start on next bulk</span></span></span>
<span class="r-in"><span><span class="co">## insert but you need to sleep in between docs_bulk calls, longer the</span></span></span>
<span class="r-in"><span><span class="co">## bigger the data is</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test1.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test2.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test3.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">files</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span>, index <span class="op">=</span> <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">count</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can include your own document id numbers</span></span></span>
<span class="r-in"><span><span class="co">## Either pass in as an argument</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_create</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test1.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test2.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test3.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">files</span>, <span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">NROW</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">tt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>           <span class="op">(</span><span class="va">tt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">tt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">tt</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="op">(</span><span class="va">tt</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">tt</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tt</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">files</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span>, index <span class="op">=</span> <span class="st">"testes"</span>, doc_ids <span class="op">=</span> <span class="va">ids</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    es_ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">count</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## or include in the input data</span></span></span>
<span class="r-in"><span><span class="co">### from data.frame's</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_create</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test1_id.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test2_id.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"test3_id.csv"</span>, package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">files</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">files</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span>, index <span class="op">=</span> <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">count</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### from lists via file inputs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_create</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">files</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">d</span>, <span class="fl">1</span>, <span class="va">as.list</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span>, index <span class="op">=</span> <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">count</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"testes"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data.frame's with a single column</span></span></span>
<span class="r-in"><span><span class="co">## this didn't use to work, but now should work</span></span></span>
<span class="r-in"><span><span class="va">db</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">letters</span>, <span class="fl">10</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_create</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">res</span>, index <span class="op">=</span> <span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="count.html">count</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">db</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data.frame with a mix of actions</span></span></span>
<span class="r-in"><span><span class="co">## make sure you use a column named 'es_action' or this won't work</span></span></span>
<span class="r-in"><span><span class="co">## if you need to delete or update you need document IDs</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="indices.html">index_exists</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"baz"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="indices.html">index_delete</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">"baz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, b <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">10</span>, c <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">df</span>, <span class="st">"baz"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html" class="external-link">Sys.sleep</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'baz'</span>, asdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"a"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">99</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"c"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"aa"</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">[</span><span class="fl">3</span>, <span class="st">"c"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">33</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">[</span><span class="fl">3</span>, <span class="st">"c"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"cc"</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">es_action</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'update'</span>, <span class="st">'delete'</span>, <span class="st">'update'</span>, <span class="st">'delete'</span>, <span class="st">'delete'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span><span class="op">$</span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">`_id`</span></span></span>
<span class="r-in"><span><span class="va">df</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">df</span>, <span class="st">"baz"</span>, es_ids <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### or es_ids = FALSE and pass in document ids to doc_ids</span></span></span>
<span class="r-in"><span><span class="co"># invisible(docs_bulk(df, "baz", es_ids = FALSE, doc_ids = df$id))</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Search.html">Search</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">'baz'</span>, asdf<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">hits</span><span class="op">$</span><span class="va">hits</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Curl options</span></span></span>
<span class="r-in"><span><span class="va">plosdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"plos_data.json"</span>,</span></span>
<span class="r-in"><span>  package <span class="op">=</span> <span class="st">"elastic"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plosdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="type_remover.html">type_remover</a></span><span class="op">(</span><span class="va">plosdat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">plosdat</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># suppress progress bar</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">mtcars</span>, index <span class="op">=</span> <span class="st">"hello"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## vs.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu">docs_bulk</span><span class="op">(</span><span class="va">x</span>, <span class="va">mtcars</span>, index <span class="op">=</span> <span class="st">"hello"</span>, quiet <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg"></div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul></div>
                    <div class="col-md-3 col-sm-4">
                        <ul><h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul></div>
                    <div class="col-md-2 col-sm-4">
                        <ul><h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul></div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer></div>

  

  

  </body></html>

